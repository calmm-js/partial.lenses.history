!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("infestines"),require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses"],e):e(n.H={},n.I,n.L)}(this,function(n,s,e){"use strict";function t(n,e){var t=e.v,r=e.i,u=e.c;if(u.e&&s.acyclicEqualsU(a(r,t),n))return e;var i=e.t,o=Date.now(),c=r+(u.p<=o-a(r,i)),f=Math.max(0,c-u.m);return v(c-f,d(o,l(f,c,i)),d(n,l(f,c,t)),u)}var a=function(n,e){return e[n]},d=function(n,e){return e.concat([n])},l=function(n,e,t){return 0===n&&u(t)===e?t:t.slice(n,e)},r=function(n,e){return l(n,u(e),e)},u=function(n){return n.length},i=function(n,e){return l(0,n,e)},o=function(n){return[n]},c=function(n){return n-1},v=function(n,e,t,r){return{i:n,t:e,v:t,c:r}},f=function(n,e){return v(Math.max(0,Math.min(n,m(e)-1)),e.t,e.v,e.c)},p=s.curryN(2,function(n){var e={p:(n=n||0).replacePeriod||0,e:!n.pushEquals,m:Math.max(1,n.maxCount||-1>>>1)-1};return function(n){return v(0,o(Date.now()),o(n),e)}}),m=function(n){return u(n.v)},x=function(n){return n.i},y=s.curry(f),h=e.lens(x,f),w=function(n){return a(n.i,n.v)},C=s.curry(t),M=e.lens(w,t),q=e.modify(h,c),P=function(n){return m(n)-1-n.i},g=e.lens(P,function(n,e){return y(m(e)-1-n,e)}),I=e.modify(g,c);n.init=p,n.count=m,n.index=x,n.setIndex=y,n.viewIndex=h,n.present=w,n.setPresent=C,n.viewPresent=M,n.undoCount=x,n.viewUndoCount=h,n.undo=q,n.undoForget=function(n){return v(0,r(n.i,n.t),r(n.i,n.v),n.c)},n.redoCount=P,n.viewRedoCount=g,n.redo=I,n.redoForget=function(n){return v(n.i,i(n.i+1,n.t),i(n.i+1,n.v),n.c)},Object.defineProperty(n,"__esModule",{value:!0})});

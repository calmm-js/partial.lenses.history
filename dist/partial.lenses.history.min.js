!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),0,require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses.validation","partial.lenses"],r):r(n.H={},n.I,0,n.L)}(this,function(n,a,r,t){"use strict";function c(n){for(var r=0;i<<r<n;)r+=d;return r}function l(n,r){n+=r.l;for(var t=c(r.u),e=r.r;0!==t;)e=e[n>>t&p],t-=d;return e[n&p]}function s(n,r){var t=r.u,e=c(t),u=r.r;return x(r.l,t+1,t>>e<i?y(e,t,n,u):[u,y(e,t,n,"")])}function v(n,r,t){if(r<=n)return m;if(0===n&&h(t)===r)return t;for(var e=t.l+n,u=e+r-n,i=t.r,o=c(t.u);0!==o&&(e>>o&p)==(u-1>>o&p);){var f=e&p<<o;i=i[e>>o&p],e-=f,u-=f,o-=d}return t.u!==u&&(i=g(o,u-1,i)),t.l!==e&&(i=M(o,e,i)),x(e,u,i)}function e(n,r){var t=r.v,e=r.i,u=r.c;if(u.e&&a.acyclicEqualsU(l(e,t),n))return r;var i=r.t,o=Date.now(),f=e+(u.p<=o-l(e,i)),c=Math.max(0,f-u.m);return q(f-c,s(o,v(c,f,i)),s(n,v(c,f,t)),u)}var d=4,i=1<<d,p=i-1,x=function(n,r,t){return{l:n,u:r,r:t}},m=x(0,0,a.array0),u=function(n){return x(0,1,[n])},h=function(n){return n.u-n.l},y=(0,a.id)(function(n,r,t,e){for(var u=r>>n&p,i=0!==n?y(n-d,r,t,e[u]||""):t,o=[],f=0,c=e.length;f<c;++f)o[f]=e[f];return o[u]=i,o}),M=(0,a.id)(function(n,r,t){for(var e=r>>n&p,u=0!==n?M(n-d,r,t[e]):t[e],i=[],o=0;o<e;++o)i[o]=null;i[e]=u;for(var f=e+1,c=t.length;f<c;++f)i[f]=t[f];return i}),g=(0,a.id)(function(n,r,t){for(var e=r>>n&p,u=0!==n?g(n-d,r,t[e]):t[e],i=[],o=0;o<e;++o)i[o]=t[o];return i[e]=u,i}),o=function(n,r){return v(n,h(r),r)},f=function(n,r){return v(0,n,r)},q=function(n,r,t,e){return{i:n,t:r,v:t,c:e}},I=function(n,r){return q(Math.max(0,Math.min(n,D(r))),r.t,r.v,r.c)},b=a.curryN(2,function(n){var r={p:(n=n||0).replacePeriod||0,e:!n.pushEquals,m:Math.max(1,n.maxCount||-1>>>1)-1};return function(n){return q(0,u(Date.now()),u(n),r)}}),j=function(n){return h(n.v)},w=t.lens(function(n){return n.i},I),D=function(n){return h(n.v)-1},E=t.lens(function(n){return l(n.i,n.v)},e),F=function(n){return q(0,o(n.i,n.t),o(n.i,n.v),n.c)},P=t.lens(function(n){return D(n)-n.i},function(n,r){return I(D(r)-n,r)}),_=function(n){return q(n.i,f(n.i+1,n.t),f(n.i+1,n.v),n.c)},C=function(n){return n},H=C(b),L=C(E),N=C(w),O=C(F),U=C(P),k=C(_),z=C(j),A=C(w),B=C(D);n.init=H,n.present=L,n.undoIndex=N,n.undoForget=O,n.redoIndex=U,n.redoForget=k,n.count=z,n.index=A,n.indexMax=B,Object.defineProperty(n,"__esModule",{value:!0})});

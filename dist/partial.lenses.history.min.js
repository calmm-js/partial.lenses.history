!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines"),0,require("partial.lenses")):"function"==typeof define&&define.amd?define(["exports","infestines","partial.lenses.validation","partial.lenses"],r):r(n.H={},n.I,0,n.L)}(this,function(n,a,r,t){"use strict";function c(n){for(var r=0;i<<r<n;)r+=p;return r}function l(n,r){n+=r.l;for(var t=c(r.u),e=r.r;0!==t;)e=e[n>>t&x],t-=p;return e[n&x]}function s(n,r,t,e){for(var u=r>>n&x,i=0!==n?s(n-p,r,t,e[u]||""):t,o=[],f=0,c=e.length;f<c;++f)o[f]=e[f];return o[u]=i,o}function v(n,r){var t=r.u,e=c(t),u=r.r;return m(r.l,t+1,t>>e<i?s(e,t,n,u):[u,s(e,t,n,"")])}function d(n,r,t){if(r<=n)return h;if(0===n&&y(t)===r)return t;for(var e=t.l+n,u=e+r-n,i=t.r,o=c(t.u);0!==o&&(e>>o&x)==(u-1>>o&x);){var f=e&x<<o;i=i[e>>o&x],e-=f,u-=f,o-=p}return t.u!==u&&(i=function n(r,t,e){for(var u=t>>r&x,i=0!==r?n(r-p,t,e[u]):e[u],o=[],f=0;f<u;++f)o[f]=e[f];return o[u]=i,o}(o,u-1,i)),t.l!==e&&(i=function n(r,t,e){for(var u=t>>r&x,i=0!==r?n(r-p,t,e[u]):e[u],o=[],f=0;f<u;++f)o[f]=null;o[u]=i;for(var c=u+1,a=e.length;c<a;++c)o[c]=e[c];return o}(o,e,i)),m(e,u,i)}function e(n,r){var t=r.v,e=r.i,u=r.c;if(u.e&&a.acyclicEqualsU(l(e,t),n))return r;var i=r.t,o=Date.now(),f=e+(u.p<=o-l(e,i)),c=Math.max(0,f-u.m);return M(f-c,v(o,d(c,f,i)),v(n,d(c,f,t)),u)}var p=4,i=1<<p,x=i-1,m=function(n,r,t){return{l:n,u:r,r:t}},h=m(0,0,[]),u=function(n){return m(0,1,[n])},y=function(n){return n.u-n.l},o=function(n,r){return d(n,y(r),r)},f=function(n,r){return d(0,n,r)},M=function(n,r,t,e){return{i:n,t:r,v:t,c:e}},g=function(n,r){return M(Math.max(0,Math.min(n,j(r))),r.t,r.v,r.c)},q=a.curryN(2,function(n){var r={p:(n=n||0).replacePeriod||0,e:!n.pushEquals,m:Math.max(1,n.maxCount||-1>>>1)-1};return function(n){return M(0,u(Date.now()),u(n),r)}}),I=function(n){return y(n.v)},b=t.lens(function(n){return n.i},g),j=function(n){return y(n.v)-1},w=t.lens(function(n){return l(n.i,n.v)},e),D=function(n){return M(0,o(n.i,n.t),o(n.i,n.v),n.c)},E=t.lens(function(n){return j(n)-n.i},function(n,r){return g(j(r)-n,r)}),F=function(n){return M(n.i,f(n.i+1,n.t),f(n.i+1,n.v),n.c)},P=function(n){return n},_=P(q),C=P(w),H=P(b),L=P(D),N=P(E),O=P(F),U=P(I),k=P(b),z=P(j);n.init=_,n.present=C,n.undoIndex=H,n.undoForget=L,n.redoIndex=N,n.redoForget=O,n.count=U,n.index=k,n.indexMax=z,Object.defineProperty(n,"__esModule",{value:!0})});
